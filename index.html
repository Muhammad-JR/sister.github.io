<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Favorite Sister üíñ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #a8c0ff 0%, #3f2b96 100%);
            /* Fallback/Alternate subtle pastel gradient */
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            overflow-x: hidden;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1, h2, .handwriting {
            font-family: 'Dancing Script', cursive;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .floating {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }

        /* Game Canvas Styling */
        canvas {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            touch-action: none; /* Prevents scrolling while playing */
        }
        
        .emoji-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        /* Loading Spinner */
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #fff;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-white min-h-screen flex flex-col">

    <!-- Navigation (Simple) -->
    <nav class="w-full p-6 flex justify-between items-center z-50">
        <div class="text-2xl font-bold tracking-wider">Par<span class="text-pink-300">vana.</span></div>
        <div class="space-x-4 hidden md:block">
            <a href="#home" class="hover:text-pink-200 transition">Home</a>
            <a href="#reasons" class="hover:text-pink-200 transition">Why You?</a>
            <a href="#magic-zone" class="hover:text-pink-200 transition">Magic Zone</a>
            <a href="#game" class="bg-white text-purple-600 px-4 py-2 rounded-full font-bold hover:bg-pink-100 transition shadow-lg">Play Game</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <header id="home" class="container mx-auto px-6 py-12 flex flex-col-reverse md:flex-row items-center min-h-[80vh]">
        <div class="md:w-1/2 text-center md:text-left space-y-6">
            <div class="inline-block bg-white/20 px-4 py-1 rounded-full text-sm font-semibold mb-2">
                ‚ú® The Best Sister Award Goes To...
            </div>
            <h1 class="text-6xl md:text-8xl font-bold leading-tight drop-shadow-lg">
                To My Favorite <br/> <span class="text-pink-200">Sister!</span>
            </h1>
            <p class="text-lg md:text-xl text-white/90 max-w-lg mx-auto md:mx-0">
                To the coolest, smartest, and most annoying (just kidding!) sister in the world. Here is a little corner of the internet just for you.
            </p>
            <div class="pt-4">
                <a href="#game" class="bg-gradient-to-r from-pink-500 to-purple-500 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition hover:scale-105 hover:shadow-xl inline-block">
                    Start the Fun ‚ú®
                </a>
            </div>
        </div>
        <div class="md:w-1/2 flex justify-center items-center relative mb-10 md:mb-0">
            <!-- Animated decorative circle -->
            <div class="absolute w-64 h-64 bg-pink-400 rounded-full mix-blend-multiply filter blur-2xl opacity-70 animate-blob"></div>
            <div class="absolute w-64 h-64 bg-purple-400 rounded-full mix-blend-multiply filter blur-2xl opacity-70 animate-blob animation-delay-2000 top-0 -right-4"></div>
            
            <!-- Main Image Placeholder (You can replace src with her photo) -->
            <div class="glass-card p-4 floating relative z-10 transform rotate-3">
                <img src="parootty.jpeg" alt="Sister Avatar" class="w-64 h-64 rounded-xl border-4 border-white/50 bg-white/30">
                <div class="text-center mt-2 font-bold text-gray-800 handwriting text-2xl">Super Star</div>
            </div>
        </div>
    </header>

    <!-- Reasons Why You Are Special -->
    <section id="reasons" class="container mx-auto px-6 py-20">
        <div class="text-center mb-16">
            <h2 class="text-5xl font-bold mb-4">Why You're The Best</h2>
            <div class="w-24 h-1 bg-white mx-auto rounded-full"></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Card 1 -->
            <div class="glass-card p-8 text-center hover:bg-white/30 transition duration-300 transform hover:-translate-y-2">
                <span class="emoji-icon">üß†</span>
                <h3 class="text-2xl font-bold mb-2">Super Smart</h3>
                <p class="text-white/80">You figure things out so fast. I'm always impressed by how quickly you learn new things!</p>
            </div>

            <!-- Card 2 -->
            <div class="glass-card p-8 text-center hover:bg-white/30 transition duration-300 transform hover:-translate-y-2">
                <span class="emoji-icon">üòÇ</span>
                <h3 class="text-2xl font-bold mb-2">Hilarious</h3>
                <p class="text-white/80">You always know how to make me laugh, even when I'm having a bad day.</p>
            </div>

            <!-- Card 3 -->
            <div class="glass-card p-8 text-center hover:bg-white/30 transition duration-300 transform hover:-translate-y-2">
                <span class="emoji-icon">üíñ</span>
                <h3 class="text-2xl font-bold mb-2">Kind Hearted</h3>
                <p class="text-white/80">You care about people and animals. Never lose that beautiful heart of yours.</p>
            </div>
        </div>
    </section>

    <!-- NEW GEMINI AI SECTION -->
    <section id="magic-zone" class="container mx-auto px-6 py-20">
        <div class="text-center mb-12">
            <h2 class="text-5xl font-bold mb-4">‚ú® The Magic Zone ‚ú®</h2>
            <p class="text-white/80">Powered by AI magic, just for you!</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
            
            <!-- Feature 1: Compliment Generator -->
            <div class="glass-card p-8 flex flex-col items-center text-center">
                <div class="text-5xl mb-4">ü™Ñ</div>
                <h3 class="text-2xl font-bold mb-4">Instant Cheer-Up</h3>
                <p class="mb-6 text-white/80">Feeling bored? Click the button to receive a personalized message from the Magic Mirror.</p>
                <div id="compliment-box" class="min-h-[80px] w-full bg-white/10 rounded-lg p-4 mb-4 flex items-center justify-center italic text-lg">
                    "Your magic message will appear here..."
                </div>
                <button onclick="generateCompliment()" id="compliment-btn" class="bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition transform hover:scale-105">
                    Reveal Magic Message ‚ú®
                </button>
            </div>

            <!-- Feature 2: Hero Story Generator -->
            <div class="glass-card p-8 flex flex-col items-center text-center">
                <div class="text-5xl mb-4">üìñ</div>
                <h3 class="text-2xl font-bold mb-4">Story Weaver</h3>
                <p class="mb-4 text-white/80">Type a topic (e.g., "unicorns", "homework", "ice cream") and see yourself become the hero!</p>
                
                <input type="text" id="story-topic" placeholder="Enter a topic here..." class="w-full p-3 rounded-full bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:bg-white/30 mb-4 text-center">
                
                <button onclick="generateStory()" id="story-btn" class="bg-gradient-to-r from-blue-400 to-purple-500 hover:from-blue-500 hover:to-purple-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition transform hover:scale-105 mb-4">
                    Write My Story ‚ú®
                </button>

                <div id="story-box" class="w-full bg-white/10 rounded-lg p-4 min-h-[100px] text-left text-sm max-h-60 overflow-y-auto hidden">
                    <!-- Story appears here -->
                </div>
            </div>

        </div>
    </section>

    <!-- The Game Section -->
    <section id="game" class="container mx-auto px-6 py-20 bg-black/10 rounded-3xl backdrop-blur-sm mb-20">
        <div class="flex flex-col items-center">
            <h2 class="text-4xl font-bold mb-2 text-center">üåü Catch The Stars! üåü</h2>
            <p class="mb-6 text-center text-pink-200">Help the kitty bucket catch the falling stars to increase your happiness level!</p>
            
            <div class="relative group w-full max-w-[350px]">
                <!-- Added inline style for responsive aspect ratio maintenance -->
                <canvas id="gameCanvas" width="350" height="500" class="w-full h-auto block mx-auto"></canvas>
                
                <!-- Overlay for Start -->
                <div id="startScreen" class="absolute inset-0 flex flex-col items-center justify-center bg-black/60 rounded-xl z-20">
                    <h3 class="text-3xl font-bold mb-4">Ready?</h3>
                    <button onclick="startGame()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-6 rounded-full shadow-lg transition transform hover:scale-110">
                        Start Game
                    </button>
                </div>

                <!-- Overlay for Game Over -->
                <div id="gameOverScreen" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-black/80 rounded-xl z-20">
                    <h3 class="text-3xl font-bold mb-2 text-red-300">Oh no!</h3>
                    <p class="text-xl mb-4">Score: <span id="finalScore">0</span></p>
                    <button onclick="startGame()" class="bg-white text-purple-600 font-bold py-2 px-6 rounded-full shadow-lg transition">
                        Try Again
                    </button>
                </div>
            </div>

            <!-- Controls Info -->
            <div class="mt-6 flex justify-between w-full max-w-[350px] md:justify-center md:gap-4">
                <button id="btnLeft" class="md:hidden bg-white/20 hover:bg-white/30 text-4xl p-6 rounded-full active:bg-white/40 transition select-none backdrop-blur-sm shadow-lg" style="touch-action: manipulation;">‚¨ÖÔ∏è</button>
                <div class="hidden md:block text-sm bg-white/10 px-4 py-2 rounded-lg self-center">
                    Use ‚¨ÖÔ∏è and ‚û°Ô∏è arrow keys to move
                </div>
                <button id="btnRight" class="md:hidden bg-white/20 hover:bg-white/30 text-4xl p-6 rounded-full active:bg-white/40 transition select-none backdrop-blur-sm shadow-lg" style="touch-action: manipulation;">‚û°Ô∏è</button>
            </div>
            <p class="md:hidden text-sm text-pink-200 mt-4 opacity-80">(You can also tap the left or right side of the game box!)</p>
            
            <div class="mt-6 text-2xl font-bold">
                Score: <span id="scoreDisplay">0</span>
            </div>
        </div>
    </section>

    <!-- Message Section -->
    <section class="container mx-auto px-6 py-20 text-center">
        <div class="glass-card max-w-2xl mx-auto p-10 relative">
            <i class="fas fa-quote-left text-4xl text-pink-300 absolute top-4 left-4 opacity-50"></i>
            <h2 class="text-3xl font-bold mb-6">A Message From Your Brother</h2>
            <p class="text-lg leading-relaxed mb-6 font-light">
                Watching you grow up has been one of my favorite things. You are becoming such an amazing person. 
                Always remember that no matter how old you get, I'll always have your back. Keep shining bright, little sis.
            </p>
            <p class="handwriting text-3xl text-pink-200">- Big Brother</p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black/20 text-center py-6 mt-auto">
        <p class="text-sm opacity-60">Made with ‚ù§Ô∏è specifically for you.</p>
    </footer>

    <script>
        // --- Gemini API Logic ---
        const apiKey = ""; // System provides this

        async function callGemini(prompt) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: prompt }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error("Gemini Error:", error);
                return "Oops! The magic crystals are cloudy right now. Try again later! ‚ú®";
            }
        }

        async function generateCompliment() {
            const btn = document.getElementById('compliment-btn');
            const box = document.getElementById('compliment-box');
            
            // Loading State
            const originalText = btn.innerText;
            btn.innerHTML = '<span class="loader"></span>';
            btn.disabled = true;
            
            const prompt = "Give me a unique, funny, cute, or heartwarming compliment for a 13-year-old sister. It should sound like it is coming from a cool, supportive big brother. Keep it short (under 2 sentences) and cheerful. Do not use quotes.";
            
            const text = await callGemini(prompt);
            
            // Typewriter effect logic could go here, but simple fade is good for now
            box.style.opacity = 0;
            setTimeout(() => {
                box.innerText = text;
                box.style.opacity = 1;
            }, 300);
            box.style.transition = "opacity 0.5s ease";

            // Reset Button
            btn.innerText = originalText;
            btn.disabled = false;
        }

        async function generateStory() {
            const topicInput = document.getElementById('story-topic');
            const btn = document.getElementById('story-btn');
            const box = document.getElementById('story-box');
            
            const topic = topicInput.value.trim() || "a magical adventure";

            // Loading State
            const originalText = btn.innerText;
            btn.innerHTML = '<span class="loader"></span> weaving magic...';
            btn.disabled = true;
            box.classList.remove('hidden');
            box.innerText = "Consulting the story elves...";
            
            const prompt = `Write a very short (max 60 words), funny, and empowering mini-story where a 13-year-old girl is the main hero. The theme of the story is: ${topic}. Make her sound awesome.`;
            
            const text = await callGemini(prompt);
            
            box.innerText = text;

            // Reset Button
            btn.innerText = originalText;
            btn.disabled = false;
        }


        // --- Game Logic ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const finalScoreDisplay = document.getElementById('finalScore');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');

        let score = 0;
        let gameRunning = false;
        let animationId;

        // Player (Bucket)
        const player = {
            x: canvas.width / 2 - 25,
            y: canvas.height - 60,
            width: 50,
            height: 50,
            speed: 7, // Increased speed for snappier feel
            dx: 0
        };

        // Falling Items
        let items = [];
        const itemSpeed = 3;
        const spawnRate = 60; // Frames
        let frameCount = 0;

        // Controls
        let rightPressed = false;
        let leftPressed = false;

        document.addEventListener('keydown', keyDownHandler);
        document.addEventListener('keyup', keyUpHandler);

        // Mobile Controls - Buttons
        const btnLeft = document.getElementById('btnLeft');
        const btnRight = document.getElementById('btnRight');

        // Helper to add touch events safely
        function addTouchControl(elem, direction) {
             elem.addEventListener('touchstart', (e) => { 
                e.preventDefault(); 
                if(direction === 'left') leftPressed = true;
                else rightPressed = true;
            }, {passive: false});
            
            elem.addEventListener('touchend', (e) => { 
                e.preventDefault(); 
                if(direction === 'left') leftPressed = false;
                else rightPressed = false;
            }, {passive: false});
        }

        addTouchControl(btnLeft, 'left');
        addTouchControl(btnRight, 'right');

        // Also allow mouse interaction for testing
        btnLeft.addEventListener('mousedown', () => { leftPressed = true; });
        btnLeft.addEventListener('mouseup', () => { leftPressed = false; });
        btnRight.addEventListener('mousedown', () => { rightPressed = true; });
        btnRight.addEventListener('mouseup', () => { rightPressed = false; });


        // Canvas Direct Touch Zones (Split Screen Control)
        // Uses visual bounding box to ensure accuracy even when canvas is resized by CSS
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            handleTouch(e.touches);
        }, {passive: false});

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault(); // Prevent scrolling while dragging
            handleTouch(e.touches);
        }, {passive: false});

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            handleTouch(e.touches); 
        }, {passive: false});

        function handleTouch(touches) {
            // Reset first
            leftPressed = false;
            rightPressed = false;
            
            const rect = canvas.getBoundingClientRect();
            
            // Loop through all active touches
            for (let i = 0; i < touches.length; i++) {
                const touchX = touches[i].clientX - rect.left;
                // Use rect.width (visual width) instead of canvas.width (internal resolution)
                if (touchX < rect.width / 2) {
                    leftPressed = true;
                } else {
                    rightPressed = true;
                }
            }
        }


        function keyDownHandler(e) {
            if(e.key === "Right" || e.key === "ArrowRight") rightPressed = true;
            else if(e.key === "Left" || e.key === "ArrowLeft") leftPressed = true;
        }

        function keyUpHandler(e) {
            if(e.key === "Right" || e.key === "ArrowRight") rightPressed = false;
            else if(e.key === "Left" || e.key === "ArrowLeft") leftPressed = false;
        }

        function spawnItem() {
            const size = 30;
            const x = Math.random() * (canvas.width - size);
            // 80% chance for Star (good), 20% for Rock (bad)
            const isStar = Math.random() > 0.2; 
            items.push({
                x: x,
                y: -size,
                size: size,
                type: isStar ? 'star' : 'rock',
                emoji: isStar ? 'üåü' : 'üåë'
            });
        }

        function drawPlayer() {
            ctx.font = "40px Arial";
            ctx.fillText("üß∫", player.x, player.y + 40);
        }

        function drawItems() {
            ctx.font = "30px Arial";
            items.forEach((item) => {
                ctx.fillText(item.emoji, item.x, item.y + 30);
            });
        }

        function update() {
            if (!gameRunning) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Move Player
            if (rightPressed && player.x < canvas.width - player.width) {
                player.x += player.speed;
            } else if (leftPressed && player.x > 0) {
                player.x -= player.speed;
            }

            // Spawn Items
            frameCount++;
            if (frameCount % spawnRate === 0) {
                spawnItem();
            }

            // Move and Check Items
            for (let i = 0; i < items.length; i++) {
                items[i].y += itemSpeed;

                // Collision Detection
                if (
                    items[i].x < player.x + player.width &&
                    items[i].x + items[i].size > player.x &&
                    items[i].y < player.y + player.height &&
                    items[i].y + items[i].size > player.y
                ) {
                    if (items[i].type === 'star') {
                        score += 10;
                        scoreDisplay.innerText = score;
                    } else {
                        gameOver();
                        return;
                    }
                    items.splice(i, 1);
                    i--;
                    continue;
                }

                // Remove if off screen
                if (items[i].y > canvas.height) {
                    items.splice(i, 1);
                    i--;
                }
            }

            drawPlayer();
            drawItems();

            animationId = requestAnimationFrame(update);
        }

        function startGame() {
            score = 0;
            items = [];
            scoreDisplay.innerText = score;
            gameRunning = true;
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            frameCount = 0;
            update();
        }

        function gameOver() {
            gameRunning = false;
            cancelAnimationFrame(animationId);
            finalScoreDisplay.innerText = score;
            gameOverScreen.classList.remove('hidden');
        }

        // Initial Draw
        ctx.fillStyle = "white"; // Not really used with emojis, but good reset
        drawPlayer();

    </script>
</body>
</html>
